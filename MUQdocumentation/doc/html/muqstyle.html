<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MUQ: MUQ Development Style</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MUQ
   &#160;<span id="projectnumber">0.02</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('muqstyle.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MUQ Development Style </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="uncrustify"></a>
Uncrustify code formatting</h1>
<p>MUQ uses uncrustify to ensure that all the files look good and are similar. It will also insert the license header into any .h or .cpp that does not lead with a comment.</p>
<p>Install uncrustify from source, it's easy. <a href="http://uncrustify.sourceforge.net/">http://uncrustify.sourceforge.net/</a> Get 0.60.</p>
<p>This style is checked on all altered files with a git hook. Create a link from repo/muq-pre-commit to .git/hooks/pre-commit, which should be executable. On commit, commits will fail if all files do not pass the style check. If they fail, it will show you the diff and then provide a patch. The "git patch" command output can be executed, the changes added, and then try the commit again. It also might yell at you about trailing whitespace. Unfortunately, you can't fix these things transparently during the commit hook.</p>
<p>If you're on kdevelop, you can get the Edit-&gt;"Reformat source" to work under Settings-&gt;Configure Kdevelop-&gt;Source formatter. Create a custom script, and set it to "uncrustify -l CPP -q". This will read from ~/.uncrustify.cfg, so create a sym link from that to your repo, or add -c [uncrustify.cfg in your repo].</p>
<p>Uncrustify oddness notes:</p><ul>
<li>It doesn't seem to like the new c++ {} to call a constructor - it took out the ; in one example.</li>
<li>If you have a one line macro without a ;, it might move the following lines up. This is syntactically okay, as the macro usually has the semicolon, but it looks bad. Add a ; and it'll be fine.</li>
<li>If it reflows a comment for you, you seem to need to run it twice. It doesn't add spaces to the wrapped lines the first go around.</li>
<li><p class="startli">Reflowing only works for lines that are too long, it grab stuff from the next line,to fix up the whole paragraph, but you can always merge the lines and force it to reflow.</p>
<p class="startli">I propose that when we're ready, I'll apply the formatter to everything at once. This will produce a horrible commit that will touch tons of things. Then, if we decide to tweak the config, we'll apply it as we go, except that on named releases we might make sure it's universally applied.</p>
</li>
</ul>
<h1><a class="anchor" id="styleconventions"></a>
C++ style and naming conventions</h1>
<p>I often like the google c++ style guide for such things. They have smart people who thought hard about this stuff, although they are much more conservative on some things, which I'm sure stems from the size of their projects and staff. For example, they don't use much boost or c++11, and forbid "using namespace". I think we can loosen those. I also don't like underscores as much as they do. My thoughts, as a starting point - sorry this list got long:</p><ul>
<li>Forward declares: avoid including files from .h if you can get away with a single forward declare. A Foo_fwd.h can be nice if it's a complicated header that creates a bunch of classes, but I wouldn't bother if Foo.h only has class Foo. This creates shorter dependency chains. (I'm trying to work on this, most of the code doesn't do this). Otherwise, don't worry too much.</li>
<li>Namespaces: modules get namespaces inside muq. Lower case names.</li>
<li>Using: I put using commands in cpps whenever the namespace is used more than a few times. I leave function inputs fully qualified because I'm always copy/pasting between the cpp and the h. Google hates "using namespace", but you can make aliases and using inside functions or classes - I think they're worried about leaking namespaces. -I hate underscores. Prefixing class members with underscores is, to my mind, only annoying to type.</li>
<li>Camel case.</li>
<li>Function names. Lead with Upper. AFunction. DoSomething. If it's an accessor for x, getX or setX, or maybe set_x, get_x. Don't be more creative.</li>
<li>Members. Lead with lower case. numInputs.</li>
<li>Boilerplate: let uncrustify put the license in. From google: "If you make significant changes to a file with an author line, consider deleting the author line." Thus, it uses MIT as the copyright line.</li>
<li>Comments: // for one line, / * * /only for big blocks. <em>Doxygen comments : I use /// for one liners or briefs, followed by /</em>. I don't really care whether this is consistent throughout.</li>
<li>Mostly one public class per file, of the same name.If it's a helper class, go ahead and add it alongside the namesake class. An exception is ModPieceTemplates.h</li>
<li>General naming: Google "Give as descriptive a name as possible, within reason. Do not worry about saving horizontal space as it is far more important to make your code immediately understandable by a new reader. Do not use abbreviations that are ambiguous or unfamiliar to readers outside your project, and do not abbreviate by deleting letters within a word."
 - input ordering: Google "When defining a function, parameter order is: inputs, then outputs."</li>
<li>Globals: avoid if possible, but we use them to make the registration magic happen</li>
<li>non-member functions can be good because they have minimal access to your classes</li>
<li>Copy constructors: I typically don't write copy constructors, but I don't ever copy any of our objects, essentially. Everything is handled with shared_ptr</li>
<li>Shared_ptr is your friend. No naked new unless you really need it, probably because of an external interface. In theory, unique_ptr is better, but there's no make_unique in c++ 11 (an odd oversight), and we do share a lot of things.</li>
<li>Include order : google :"Use standard order for readability and to avoid hidden dependencies: C library, C++
 library, other libraries' .h, your project's .h."</li>
<li>Const is your friend.Early and often, and always in function inputs whenever possible.I'm less sure that I always declare functions const that can be.</li>
<li>For boolean returning functions, I often like Is or Has prefixes for the function names.</li>
</ul>
<h1><a class="anchor" id="documentation"></a>
Documentation</h1>
<p>Use doxygen! \addgroup and \ingroup are your friends. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jul 31 2017 13:57:07 for MUQ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
